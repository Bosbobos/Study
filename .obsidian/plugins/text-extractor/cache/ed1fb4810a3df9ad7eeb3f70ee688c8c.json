{"path":"3 - Disciplines/Pentest/Files/Pentest-3-Web-Bases.pdf","text":"Московскийnинститутnэлектроникиnиn математикиnимениnА•nН•nТихонова Кафедраnинформационнойn безопасностиnкиберфизическихn систем Москваn2025 Лекцияn3:n Основыnработыnвеб~приложений Курс:nТехнологииnпентестингаn Автор:nКосмачевnАлексейnАлексеевичn 1• Клиентnиnсерверn 2• Приложениеznвеб~серверnиnвеб~сайтn 3• HTTPn 4• Ключевыеnзаголовкиn 5• Прокси~серверn 6• Архитектурыnвеб~приложенийn 7• InterceptnProxy Планnлекции 2 ПланnлекцииКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений 3 Этапыnпроведенияnтестированияnнаn проникновение Кафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений 1. Разведка 2. Сбор информации 3. Поиск уязвимостей 4. «Пробив» периметра 5. Закрепление 6. Повышение привилегий 7. Внутренняя разведка 8. Боковое перемещение 9. Реализация критического события Клиентnиnсервер 4 КлиентnиnсерверКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений 5 КлиентnиnсерверКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Клиент~сервернаяnархитектура Клиент Сервер Запросnвеб~страницы Возвращениеnвеб~страницы Потребительnинформацииn • Веб~браузерn • Консольноеnприложениеn • ПОn • Иnт•д• Производительnинформацииn 6 КлиентnиnсерверКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Клиент~сервернаяnархитектура HTTPvSw Запросnвеб~страницы Возвращениеnвеб~страницыКакойnминимальныйnнаборnнуженznчтобыnзапуститьnвеб~сайт? 7 ВопросКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений 8 ОтветКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений ~nВеб~серверnиnстатическийnконтент Какойnминимальныйnнаборnнуженznчтобыnзапуститьnвеб~сайт?Приложениеznвеб~серверnиnвеб~сайт 9 Приложениеznвеб~серверnиnвеб~сайтКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений 10 Приложениеznвеб~серверnиnвеб~сайтКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Различия Приложениеnvповарwn • Реализуетnлогикуnvязыкnпрограммированияwn • Обрабатываетnданныеn • ВзаимодействуетnсnокружениемnvБДwn • Производитnдинамическийnконтент Веб~серверnvофициантwn • Обрабатываетnзапросnклиентаn • Понимаетnкудаnконкретноnнужноn доставитьnзапросnвnприложенииn • Доставляетnстатическийnконтент Клиент Статическийnконтентn vприборыw Веб~сайт 11 Приложениеznвеб~серверnиnвеб~сайтКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Различия Веб~серверnvофициантwn • Обрабатываетnзапросnклиентаn • Понимаетnкудаnконкретноnнужноn доставитьnзапросnвnприложенииn • Доставляетnстатическийnконтент Клиент Статическийnконтентn vприборыw Веб~приложение xВеб~приложениеnбезnстатическогоnконтентаn~n APInилиnгенерируетnстатическийnконтентnнаnлету Приложениеnvповарwn • Реализуетnлогикуnvязыкnпрограммированияwn • Обрабатываетnданныеn • ВзаимодействуетnсnокружениемnvБДwn • Производитnдинамическийnконтент 12 Приложениеznвеб~серверnиnвеб~сайтКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Веб~сервера • Nginxn • ApachenHTTPnServern • MicrosoftnIISn • Caddyn • LiteSpeedn • Tomcatn • Gunicornn…nuWSGIn • … Популярныеnсвязки • NginxnynPythonnvDjango…Flask…FastAPIwn • NginxnynNode•jsnvExpress…NestJSwn • ApachenynPHPnvWordPress…Laravelwn • IISnynCqnvASP•NETnCorewn • TomcatnynJavanvSpringnBootwn • CaddynynGonvGin…Echow HTTP 13 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений 14 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений HTTP • Протоколnприкладногоnуровняn • Работаетnпоnпринципуnзапрос~ответn • БываетnшифрованнымnvHTTPSwnиnнетnvHTTPwn • Имеетnразличныеnверсии 15 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Запрос~ответ КакойnминимальныйnнаборnHTTP~запроса? 16 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений 17 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Минимальныйnзапрос GET / HTTP/1.1 Host: example.com 18 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Составныеnчасти GET / HTTP/1.1 Host: example.com Метод Путь Версия Хост 2nпереносаn строки 19 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Минимальныйnответ HTTP/1.1 200 OK 20 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Составныеnчасти Кодnответа HTTP/1.1 200 OK Версия 21 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Кодыnответа 404 Перваяnцифраnопределяетnклассnкодаnответа Остальныеnдвеnегоnномерnвnэтомnклассе • Триnцифры 22 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Классыnкодовnответа 1xxn~nинформационныеznнапример:n • 100n~nContinuen • 101n~nSwitchingnProtocols 2xxn~nкодыnуспехаznнапример:n • 200n~nOKn • 201n~nCreated 3xxn~nперенаправленияznнапример:n • 301n~nMovednPermanentlyn • 302n~nFound https:……http•cat… 23 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Классыnкодовnответа 4xxn~nошибкаnнаnсторонеnклиентаznнапример:n • 401n~nUnauthorizedn • 403n~nForbidden https:……http•cat… 5xxn~nошибкаnнаnсторонеnсервераznнапример:n • 500n~nInternalnServernErrorn • 504n~nGatewaynTimeout 24 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Метод GET / HTTP/1.1 Host: example.com Метод • Определяетnтипnпроизводимогоnдействия 25 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений ОсновныеnHTTP~методы https:……en•wikipedia•org…wiki…HTTP 26 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Путь GET /personal/profile.php HTTP/1.1 Host: example.com Путь • Позволяетnвеб~серверуnпонятьznкакойnименноn фрагментnкодаnприложенияnтребуетсяnзапуститьn vHTTPnRoutingw 27 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений HTTPnRoutingnTypes File system Routing 1• Фиксируетсяnwebnrootnnвеб~сервераnv…var…www…htmlwnn 2• Файлыnприложенияnпомещаютсяnфизическиnнаnфайловуюn системуnv…var…www…html…profile•phpwn 3• Приnобращенииnпоnпутиnвеб~приложенияnпроисходитn адрессацияnкnконкретномуnфайлуnv…profile•phpn~>n…var…www… html…profile•phpw Annotation-Based Routing (Decorator Routing) • Путиnдекларируютсяnвnдекораторахnсоответствующихn классов…функций @Controller('users') export class UsersController { @Get(':id') getUser(@Param('id') id: string) { ... } } 28 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений HTTPnRoutingnTypes Code-Based/Imperative Routing • Путиnдекларируютсяnнапрямуюnвnкоде Servlet Mappings (Java Servlet API) • Имеетсяnспециальныйnxml~файлznкоторыйnопределяетn соответствиеnпутейnобработчикамnvServletw <!-- web.xml --> <servlet-mapping> <servlet-name>UserServlet</servlet-name> <url-pattern>/users/*</url-pattern> </servlet-mapping> const app = express(); app.get('/users/:id', (req, res) => { ... }); 29 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений HTTPnRoutingnTypes Configuration-File Routing • Имеетсяnфайл~конфигурацияznопределяющийnсоответствиеn путиnиnкласса…функции Convention-Based Routing • Путиnнаследуютсяnисходяnизnназванийnv…users…show…:idn запуститnметодnshownклассаnUsersControllerw # config/routes.yaml user_profile: path: /users/{id} controller: App\\Controller\\UserController::show 30 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Версия GET /personal/profile.php HTTP/1.1 Host: example.com Версия • Определяетnформатznвnкоторомnбылиnотправленыnданные 31 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений ВерсииnHTTP HTTP…0•9 • Совсемnдревнийznнигдеnнеnиспользуетсяn • НетnзаголовковznтолькоnметодnGETznтолькоnHTMLn • Проблема:nслишкомnпримитивный HTTP…1•0 • Древнийznноnгде~тоnещеnвстречаетсяn • ПоявилисьnметодыnHEADznPOSTn • Появилисьnзаголовкиn • ПоявилисьnтипыnконтентаnvнеnтолькоnHTMLwn • ПоявилисьnкодыnсостоянияnvResponsencodeswn • Проблема:nодноnсоединениеnнаnобъект HTTP…1•1 • Старенькийznноnдоnсихnпорnсамыйnпопулярныйn • Появиласьnвозможностьnнеnобрыватьnзапросn vConnection:Keep~Alivewn • ОбязательныйnзаголовокnHostn • Появилосьnкешированиеznсжатиеznчанкованныеnданныеn vTransfer~Encoding:chunkedwn • НовыеnкодыnсостоянияnиnметодыnvPUTznDELETEznTRACEz…wn • Проблема:nГоловнаяnБлокировкаnvHead~of~LinenBlockingn~n HOLw:nМедленныйnответnнаnпервыйnзапросnвnконвейереn блокируетnвсеnпоследующиеnвnочереди 32 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений ВерсииnHTTP HTTP…2 • Широкоnиспользуетсяznноnпокаnнеnпобедилnпервуюnверсиюn • Бинарныйnпротоколnvбинарныеnфреймыnвместоnтекстаwn • Мультиплексированиеnvпараллельнаяnотправкаnзапросовnвn рамкахnодногоnTCP~соединенияwn • Приоритизацияnзапросовnvнапр•nJSnважнееnкартинокwn • Сжатиеnзаголовковn • Возможностьnотправитьnобъектыnдоnтогоnкакnихnзапросилиn • Проблема:nHOLnBlockingnуровняnTCP:nПотеряnодногоnTCP~ пакетаnблокируетnвсюnпотокnданныхnвnсоединенииznтакnкакn TCPnтребуетnстрогойnпоследовательностиnдоставки• HTTP…3 • Активноnвнедряетсяznноnещеnразвиваетсяn • ИспользуетnQUICnвместоnTCPnvработаетnповерхnUDPwn • Встроенноеnшифрованиеn • Оченьnбыстрыйn • Умеетnбыстроnпереключатьсяnмеждуnсетямиn • Проблема:nТребуетnподдержкиnиnнаnуровнеnклиентаznиnнаn уровнеnсервера 33 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Параметры GET /personal/profile.php?user=hacker&theme=dark HTTP/1.1 Host: example.com Параметры • Позволяютnпользователюnпередатьnкакую~тоn информациюnприложению 34 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Способыnпередачиnпараметров GET /personal/profile.php?user=hacker&theme=dark HTTP/1.1 Host: example.com Обычный GET-запрос GET /personal/profile.php/hacker/dark HTTP/1.1 Host: example.com GET-запрос RESTful-сервиса 35 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Способыnпередачиnпараметров POST /personal/profile.php? HTTP/1.1 Host: example.com Content-Type: application/x-www-form-urlencoded Content-Length: 22 user=hacker&theme=dark POST-запрос 36 HTTPКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Заголовки GET /personal/profile.php?user=hacker&theme=dark HTTP/1.1 Host: example.com Заголовок • Передаютnспециальнуюnинформацию…метаданныеn приложению…веб~серверу Ключевыеnзаголовки 37 КлючевыеnзаголовкиКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений 38 КлючевыеnзаголовкиКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Заголовкиnавторизацииnиnместаnхраненияnподобныхnданныхnвnбраузере Cookies • Имеютnменьшийnразмерnv~4КБwn • Отправляютсяnавтоматическиn приnкаждомnзапросеn • ДоступныnизnJSznноnэтоnможноn ограничитьnфлагамиn безопасностиn • Имеютn3nфлагаnбезопасности:n HTTPOnlyznSecureznSameSiten • Времяnжизниnможноn регулироватьn • Отправляютсяnприnпомощиn заголовкаnCookie: LocalStorage • Имеютnбольшийnразмерn v5~10МБwn • Никогдаnнеnотправляютсяn автоматическиn • ВсегдаnдоступныnизnJSn • Нетnлимитаnвремениnжизниn • Отправляютсяnприnпомощиn заголовкаnAuthorization: SessionStorage • Имеютnбольшийnразмерn v5~10МБwn • Никогдаnнеnотправляютсяn автоматическиn • ВсегдаnдоступныnизnJSn • Живутnпокаnактивнаnвкладкаn браузераn • Отправляютсяnприnпомощиn заголовкаnAuthorization: 39 КлючевыеnзаголовкиКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Заголовкиnавторизацииnиnместаnхраненияnподобныхnданныхnвnбраузере 40 КлючевыеnзаголовкиКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Прочиеnважныеnзаголовки • Hostn~nУказываетnдоменноеnимяnиnпортnсервераznкnкоторомуnобращаетсяnклиент•nvHost:nexample•comwn • Content-Typen~nУказываетnMIME~типnтелаnзапроса•nvContent~Type:napplication…jsonwn • Content-Lengthn~nУказываетnразмерnтелаnHTTP~сообщенияnвnбайтах•nvContent~Length:n1337wn • Referern~nУказываетnURLnпредыдущейnстраницыznсnкоторойnпришелnпользователь•nvReferer:nhttps:……example•com…some_pathwn • Originn~nУказываетnoriginnисточникаnзапросаnvдляnCORSw•nvOrigin:nhttps:……example•comwn • User-Agentn~nИдентифицируетnклиентскоеnПОnvбраузерznОСw•nvUser~Agent:nMozilla…5•0nvWindowsnNTn10•0;nWin64;nx64wn…wn • X-Forwarded-For (XFF) ~nИспользуетсяnпроксиnдляnуказанияnреальногоnIPnклиента•nvX~Forwarded~For:n192•168•1•1wn • Transfer-Encodingn~nИспользуетсяnдляnуказанияnформатаnотправкиnтелаnзапроса•nvTransfer~Encoding:nchunkedwn • Locationn~nЗаголовокnответа•nУказываетnURLnдляnперенаправленияnvвnответахn3xxw•nvLocation:nhttps:……example•comwn • Content-Security-Policy (CSP)n~nЗаголовокnответа•nРегулируетnправилаnзагрузкиnскриптовznфреймовnиnпрочегоnконтентаnvContent~Security~Policy:n default~srcnuselfu;w Прокси~сервер 41 Прокси~серверКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений 42 Прокси~серверКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Проксиnсервер Пользователь Прокси~сервер Запрос Приложениеn1 Приложениеn2 Условиеn1 Условиеn2 43 Прокси~серверКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений ВиртуальныйnХостnvVirtualnHostznVHostw Пользователь example•com Пользователь sub1•example•com sub1•example•comnapp sub2•example•com sub2•example•comnapp requestnfornsub1•example•com requestnfornsub2•example•com 44 Прокси~серверКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Балансировщикnнагрузки Пользователь Прокси~сервер Запрос Приложение Тоnжеnсамоеnприложение Отправлюnменееnзагруженномуn серверу Сюдаnотправлюnкакnстанетn свободнееn 45 Прокси~серверКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений ТерминацияnSSL…TLS Пользователь Прокси~сервер HTTPS~Запрос Приложение SSL~терминация СЗИnvнапр•nWAFw 46 Прокси~серверКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Кеширование Пользователь Прокси~сервер Запрос Приложение Пользователь Прокси~сервер Тотnжеnсамыйnзапрос Приложение 47 Прокси~серверКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Frontend~nиnBackend~сервера Пользователь Прокси~серверn vFrontend~servw Запросnдинамическогоnконтента Приложениеn vBackend~servw Пользователь Запросnстатическогоnконтента Иногдаnтутnпроисходитn HTTPnDowngrade Прокси~серверn vFrontend~servw Приложениеn vBackend~servw Архитектурыnвеб~приложений 48 Архитектурыnвеб~приложенийКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений 49 Архитектурыnвеб~приложенийКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Монолит 50 Архитектурыnвеб~приложенийКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Микросервиснаяnархитектура 51 Архитектурыnвеб~приложенийКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений Сервис~ориентированнаяnархитектура InterceptnProxy 52 InterceptnProxyКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений 53 InterceptnProxyКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений InterceptnProxy Пользователь InterceptnProxy Запрос Приложение Изменениеnзапроса Измененныйnзапрос 54 ФиналКафедраnинформационнойn безопасностиnкиберфизическихn систем Лекцияn3:nОсновыnработыnвеб~ приложений","libVersion":"0.5.0","langs":""}