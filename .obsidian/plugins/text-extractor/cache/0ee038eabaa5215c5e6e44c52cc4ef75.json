{"path":"3 - Disciplines/Pentest/Files/Pentest-2-Recon.pdf","text":"Московскийoинститутoэлектроникиoиo математикиoимениoА•oН•oТихонова Кафедраoинформационнойo безопасностиoкиберфизическихo систем Москваo2025 Лекцияo2:o Разведкаoиoсборoинформацииoоoцели Курс:oТехнологииoпентестингаo Автор:oКосмачевoАлексейoАлексеевичo 1• ПоискoTLDwz1xo 2• ПолучениеoинформацииoотoNSo 3• Поискoподдоменовo 4• Фильтрацияo 5• Поискoвиртуальныхoхостовo 6• Поискoподсетейo 7• Поискoсервисовo 8• Поискoдиректорийoвеб»приложенийo 9• Определениеoстекаoтехнологийo 10•Прочиеoтехникиo Планoлекции 2 ПланoлекцииКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели 3 Этапыoпроведенияoтестированияoнаo проникновение Кафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели 1. Разведка 2. Сбор информации 3. Поиск уязвимостей 4. «Пробив» периметра 5. Закрепление 6. Повышение привилегий 7. Внутренняя разведка 8. Боковое перемещение 9. Реализация критического события Исходныеoзнания:oназваниеoкомпании 4 ИсходныеoзнанияКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели ПоискoTLDwz1x 5 ПоискoTLDwz1xКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели 6 ПоискoTLDwz1xКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели ЧтоoтакоеoTLD? www.example.com Доменoверхнегоoуровняo wTop»LeveloDomain«oTLDx Доменoвторогоoуровняo wSecond»LeveloDomain«oTLDz1x ПоддоменowSubdomainx 7 ПоискoTLDwz1xКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Whois 8 ПоискoTLDwz1xКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Утилиты • dnsreconowhttps:……github•com…darkoperator…dnsreconxo • crobatowhttps:……github•com…Cgboal…SonarSearchxo • amassowhttps:……github•com…owasp»amass…amassx dnsrecon -t tld -d example.com crobat -t example.com amass intel -whois -df tld.txt БольшойoрискoFasle»Positive 9 ПоискoTLDwz1xКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели SSLowCertificateoTransparencyx Certificate Transparencyo»oпроект«oсогласноoкоторомуoCAo обязаныoпубликоватьoинформациюoоoкаждомoвыпущенномo сертификатеo • ДелаемoпоискoпоoвыпущеннымoSSL»сертификатамoкомпании https://crt.sh/?o=organization+name https://crt.sh/?q=example.com https://crt.sh/?a=1 ПолучениеoинформацииoотoNS 10 ПолучениеoинформацииoотoNSКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели 11 ПолучениеoинформацииoотoNSКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели DNS Основныеoтипыoзаписей:o • A:oIPv4oадресo • AAAA:oIPv6oадресo • CNAME:oалиасoнаoдругойoдоменo • MX:oдоменноеoимяoпочтовогоoсервераo • NS: список серверов, ответственных за разрешение доменных имен (Name Servers) • PTR:oиспользуетсяoдляoобратнойoсвязиowIP»>доменноеoимяxo • TXT:oтекстовоеoполе 12 ПолучениеoинформацииoотoNSКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели ZoneoTransfer • РепликацияoDNS»записейoсoодногоoNS»сервераoнаoдругойo • ОсуществляетсяoприoпомощиoAXFR»запросовo • Еслиoимеетсяoмисконфигурация«oвыполнитьoданнуюo операциюoможетoктоoугодноo • ВАЖНОpoЭтоoкрайнеoшумнаяoиoагрессивнаяoоперация dig axfr @ns.server.domain target.domain host -l target.domain ns.server.domain dnsrecon -a -d \"target.domain\" 13 ПолучениеoинформацииoотoNSКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели ReverseoNSoLookup • Поискoдоменов«oиспользующихoконкретныйoNSo • Вoнекоторыхoслучаяхoпозволяетoполучитьoсписокoподдоменов https://viewdns.info/reversens/?ns=ns.server.domain Поискoподдоменов 14 ПоискoподдоменовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели 15 ПоискoподдоменовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Утилиты • zdnsowhttps:……github•com…zmap…zdnsxo • altdnsowhttps:……github•com…infosec»au…altdnsxo • dnsxowhttps:……github•com…infosec»au…altdnsxo • shufflednsowhttps:……github•com…projectdiscovery…shufflednsxo • gobusterowhttps:……github•com…OJ…gobusterxo • ffufowhttps:……github•com…ffuf…ffufxo • dnsreconowhttps:……github•com…darkoperator…dnsreconxo • crobatowhttps:……github•com…Cgboal…SonarSearchxo • amassowhttps:……github•com…owasp»amass…amassx amass enum -passive -df tld.txt -config your.config amass enum -passive -norecursive -noalts -df tld.txt -config your.config crobat -s example.com dnsrecon -d \"target.domain\" 16 ПоискoподдоменовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели SSLowCertificateoTransparencyx • findomainowhttps:……github•com…Findomain…Findomainxo • subfinderowhttps:……github•com…projectdiscovery…subfinderxo • assetfinderowhttps:……github•com…tomnomnom…assetfinderx findomain -t \"target.domain\" -a subfinder -d \"target.domain\" assetfinder \"target.domain\" 17 ПоискoподдоменовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели APIs МожноoиспользоватьoAPIoследующихoсервисов AlienVault, BinaryEdge, BufferOver, BuiltWith, C99, Censys, Chaos, CIRCL, DNSDB, DNSTable, FacebookCT, GitHub, HackerOne, HackerTarget, NetworksDB, PassiveTotal, RapidDNS, Riddler, SecurityTrails, Shodan, SiteDossier, Spyse, Twitter, Umbrella, URLScan, VirusTotal, WhoisXML, ZETAlytics, Cloudflare ИмеетсяoинтеграцияoданныхoсервисовoсoamassoсoуказаниемoAPI»ключа 18 ПоискoподдоменовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Shodan • Shodanowhttps:……www•shodan•io…xo • nrichowhttps:……gitlab•com…shodan»public…nrichx echo 127.0.0.1 | nrich - nrich ip_list.txt hostname:\"target.domain\" Shodan: nrichowShodanoclix: Вoнекоторыхoслучаяхoможноoтакжеoполучитьoимеющиесяoуязвимости 19 ПоискoподдоменовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Subdomainobrute»forcing 20 ПоискoподдоменовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Subdomainobrute»forcing wget https://raw.githubusercontent.com/wavvs/lazydns/master/resolvers.txt 1•oПолучениеoспискаoрезолверовowNS»серверовx;oтакже«oможноoиспользоватьoсобственныеoNS»сервераoкомпании https://github.com/assetnote/commonspeak2-wordlists/blob/master/subdomains/subdomains.txt https://github.com/danielmiessler/SecLists/blob/master/Discovery/DNS/dns-Jhaddix.txt https://github.com/wavvs/lazydns/blob/master/wordlists/normal.txt https://github.com/wavvs/lazydns/tree/master/wordlists/big.txt 2•oПолучениеoспискаoпотенциальныхoподдоменов 21 ПоискoподдоменовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Subdomainobrute»forcing zdns A --name-servers=@resolvers.txt -input-file wordlist.txt -threads 50 -retries 3 -go-processes 5 | tee result_A.json zdns CNAME --name-servers=@resolvers.txt -input-file wordlist.txt -threads 50 -retries 3 -go- processes 5 | tee result_CNAME.json zdns AAAA --name-servers=@resolvers.txt -input-file wordlist.txt -threads 50 -retries 3 -go- processes 5 | tee result_AAAA.json 3•oЗапускoперебора altdns -i resolved_domains.txt -w words.txt -o permutated.txt 4•oПоискoизмененныхoдоменныхoименoдляoобнаруженныхoдоменов 22 ПоискoподдоменовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Subdomainobrute»forcing zdns A --name-servers=@resolvers.txt -input-file permutated.txt -threads 50 -retries 3 -go- processes 5 | tee result_A.json zdns CNAME --name-servers=@resolvers.txt -input-file permutated.txt -threads 50 -retries 3 -go- processes 5 | tee result_CNAME.json zdns AAAA --name-servers=@resolvers.txt -input-file permutated.txt -threads 50 -retries 3 -go- processes 5 | tee result_AAAA.json 5•oРазрешениеowResolvexoдоменныхoимен dnsrecon -t brt -d \"target.domain\" -n \"nameserver.com\" -D \"/path/to/wordlist\" gobuster dns --domain \"target.domain\" --resolver \"nameserver\" --wordlist \"/path/to/wordlist\" Дополнительныеoутилиты: Фильтрация 23 ФильтрацияКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели 24 ФильтрацияКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Wildcardodomains *.example.com A 127.0.0.1 • DNS»записьoвида: nonexistantsubdomain•example•com anothernonexistantsubdomain•example•com 127•0•0•1 25 ФильтрацияКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели БыстраяoпроверкаoнаoWildcardodomains dig a 'nonexistentdomain0123456789.example.com' dig a ‘*.example.com' Замечания:o • Вoнекоторыхoконфигурацияхoразрешенowildcard»домен«oоднакоoнеoбудетoответаoнаoзапросoy•example•como • Вoнекоторыхoконфигурацияхoбудетoимитироватьсяowildcard»домен«oоднакоoразныйoконтентoбудетoотображатьсяoприo обращенииoпоoразнымoподдоменамowвиртуальныеoхостыx 26 ФильтрацияКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели ПроверкаoнаoWildcardodomains dnsx -r resolvers.txt -l wordlist.txt -wd domain.to.filter.com -o output.txt shuffledns -d domain.to.filter.com -list wordlist.txt -r resolvers.txt Утилитыoсчитаютoколичествоoдоменов«oкоторыеoразрешаютсяoвoодинoиoтотoжеoIP»адресo Приoпреодоленииoлимитаoдоменыoбудутoпроверятьсяoнаowildcard Поискoвиртуальныхoхостов 27 ПоискoвиртуальныхoхостовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели 28 ПоискoвиртуальныхoхостовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели ВиртуальныйoХостowVirtualoHost«oVHostx Пользователь example•com Пользователь sub1•example•com sub1•example•comoapp sub2•example•com sub2•example•comoapp requestoforosub1•example•com requestoforosub2•example•com 29 ПоискoвиртуальныхoхостовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Утилиты • BurpoSuiteoIntruderowhttps:……portswigger•net…burpxo • ffufowhttps:……github•com…ffuf…ffufxo • wfuzzowhttps:……github•com…xmendez…wfuzzxo • gobusterowhttps:……github•com…OJ…gobusterx gobuster vhost --wordlist \"/path/to/wordlist.txt\" --url your_url wfuzz -H \"Host: FUZZ.target.domain\" --hc 404,403 -c -z file,\"/path/to/wordlist.txt\" your_url ffuf -w /path/to/wordlist.txt -u https://target.domain -H \"Host: FUZZ\" ffuf -H \"Host: FUZZ.target.domain\" -c -w \"/path/to/wordlist.txt\" -u your_url ffuf -c -r -w \"/path/to/wordlist.txt\" -u «http://FUZZ.target.domain/\" Поискoподсетей 30 ПоискoподсетейКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели 31 ПоискoподсетейКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Онлайн»поиск https://securitytrails.com/domain/target.domain/history/a https://viewdns.info/iphistory/?domain=target.domain PTR»записи dnsrecon -r 127.0.0.1/24 -d . amass intel -ip -src -addr 127.0.0.1 amass intel -ip -src -cidr 127.0.0.1/24 amass intel -ip -src -asn 2025 32 ПоискoподсетейКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели БазыoданныхoForwardoDNSowFDNSx crobat -r 127.0.0.1/24 amass intel -addr 127.0.0.1 amass intel -cidr 127.0.0.1/24 amass intel -asn 2025 Поискoсервисов 33 ПоискoсервисовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели 34 ПоискoсервисовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Утилиты • nmapowhttps:……nmap•org…xo»oмедленнее«oноoточнееo • masscanowhttps:……github•com…robertdavidgraham…masscanxo»oбыстрее«oноoменееoточный nmap -Pn -p- --open -vv -T4 -iL subdomains.txt -oA nmap_results nmap -Pn -sV -p- --open -vv -iL subdomains.txt -oA nmap_results nmap -Pn -sV -p- --open -vv --version-all -iL subdomains.txt -oA nmap_results 35 ПоискoсервисовКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Поискoвеб»приложений • httpxowhttps:……github•com…projectdiscovery…httpxxo • httprobeowhttps:……github•com…tomnomnom…httprobex httpx -ports 80,81,443,2053,2078,2079,2080,2083,2087,2090,2091,2096,2435,2942,5021,5353,5656,5357,5985,60 92,6767,7080,7081,7088,7183,7419,7706,8008,8080,8081,8088,8172,8181,8401,8443,8880,8888,900 1,9002,9003,9004,9419,9525,9998,15672,33034,47001,47279,52223,52227,52229,52231,52233 -l subdomains.txt > http_subdomains.txt Визуальноеoотображениеoвеб»приложений • aquatoneowhttps:……github•com…michenriksen…aquatonexo • WitnessMeowhttps:……github•com…byt3bl33d3r…WitnessMexo • EyeWitnessowhttps:……github•com…RedSiege…EyeWitnessx cat http_subdomains.txt | aquatone cat nmap.xml | aquatone -nmap Поискoдиректорийoвеб»приложений 36 Поискoдиректорийoвеб»приложенийКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели 37 Поискoдиректорийoвеб»приложенийКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Поискoпоoисточникам • gauowhttps:……github•com…lc…gauxoo • waybackurlsowhttps:……github•com…tomnomnom…waybackurlsx cat domains.txt | waybackurls > urls.txt cat domains.txt | gau -b ttf,woff,svg,png,jpg > urls.txt 38 Поискoдиректорийoвеб»приложенийКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели ФаззингowFuzzingx • gobusterowhttps:……github•com…OJ…gobusterxo • ffufowhttps:……github•com…ffuf…ffufxo»oможетoделатьoрекурсивныйoфаззингo • dirsearchowhttps:……github•com…maurosoria…dirsearchxo»oможетoделатьoрекурсивныйoфаззингo • dirbowhttp:……dirb•sourceforge•net…xo • dirbusterowhttps:……sourceforge•net…projects…dirbuster…xo • wfuzzowhttps:……github•com…xmendez…wfuzzxo • feroxbusterowhttps:……github•com…epi052…feroxbusterxo»oможетoделатьoрекурсивныйoфаззинг ffuf -w /path/to/wordlist -u https://target.domain/FUZZ ffuf -c -w \"/path/to/wordlist.txt\" -maxtime-job 60 -recursion -recursion-depth 2 -u your_url/FUZZ gobuster dir --wordlist \"/path/to/wordlist.txt\" --url your_url wfuzz --hc 404,403 -c -z file,\"/path/to/wordlist.txt\" your_url/FUZZ feroxbuster -w \"/path/to/wordlist.txt\" -u http://target.domain/ 39 Поискoдиректорийoвеб»приложенийКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели ФаззингowFuzzingx Важно! ФаззингoчастоoможетoвызыватьoотказoвoобслуживанииowDoSxoиз»заoбольшогоo количестваoзапросовoвoсекундуowособенноoffufoиoferoxbusterx«oпоэтомуo скоростьoработыoутилитoнужноoограничивать 40 Поискoдиректорийoвеб»приложенийКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели FuzzingoWordlists • https:……github•com…Bo0oM…fuzz•txt…blob…master…fuzz•txtoo • https:……wordlists•assetnote•ioo • https:……github•com…assetnote…wordlistsoo • https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content • https:……github•com…random»robbie…bruteforce»listsoОпределениеoстекаoтехнологий 41 ОпределениеoстекаoтехнологийКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели 42 ОпределениеoстекаoтехнологийКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Утилиты • whatwebowhttps:……github•com…urbanadventurer…whatwebxoo • wappalyzerowhttps:……www•wappalyzer•com…x whatweb https://terget.domain 43 ОпределениеoстекаoтехнологийКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели ОпределениеoязыкаoпрограммированияoпоoрасширениюoфайлаoвoURL • •php«o•php5«ophtml«o…o»>oPHPo • •aspxo»>oCr…VB•NETowASP•NETxo • •aspo»>oVBScriptowclassicoASPxo • •jsp«o•jspx«o•doo»>oJavao • •plo»>oPerlo • •pyo»>oPythonowвстречаетсяoредкоxo • •rbo»>oRubyowвстречаетсяoредкоx https://target.domain/profile.phpПрочиеoтехники 44 ПрочиеoтехникиКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели 45 ПрочиеoтехникиКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели GoogleoDorks • «»o»oпоискoконкретногоoвхожденияo • »testo»oисключениеoстраниц«oсодержащихo«test»oo • site:example•como»oпоискoтолькоoпоoдоменамo«site•com»o • inurl:keywordo»oпоискoпоoключевымoсловамoвoURLo • filetype:xlso»oпоискoпоoрасширениямoфайловo • Иoмногоoдругого… site:*.target.domain -www Поискoподдоменов«oисключаяoужеoнайденныеowwwwx https:……gist•github•com…sundowndev…283efaddbcf896ab405488330d1bbc06o https:……www•exploit»db•com…google»hacking»databaseowПримерыxo СуществуютoподобныеoдляoдругихoбраузеровoиoGit 46 ПрочиеoтехникиКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Cloudodiscovery • s3reconowhttps:……github•com…clarketm…s3reconxo • grayhatwarwareowhttps:……buckets•grayhatwarfare•com…x s3recon \"keywords-list.txt\" -o \"results.json\" --public https://buckets.grayhatwarfare.com/buckets/0/BUCKET_NAME https://buckets.grayhatwarfare.com/results/FILE_NAME Наoчтоoещеoобращаемoвнимание • ИнформацияoнаoстраницеowСекцииoCredits«oContactsxo • НестандартныеoHTTP»заголовкиo • Файлыorobots•txt«ositemap•xml«o•DS_Store«o…o • КомментарииoиoметаданныеowHTML»«oCSS»«oJS»файлыxo • ЛогиoошибокowStackTracex 47 ПрочиеoтехникиКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели Бонус:oопределениеoвеб»сервераoпоoстандартнойoошибкеo404 https:……0xdf•gitlab•io…cheatsheets…404o 48 ПрочиеoтехникиКафедраoинформационнойo безопасностиoкиберфизическихo систем Лекцияo2:oРазведкаoиoсборo информацииoоoцели","libVersion":"0.5.0","langs":""}